attack_technique: T1654
display_name: "Log Enumeration"
atomic_tests:
- name: Get-EventLog To Enumerate Windows Security Log
  auto_generated_guid: 
  description: |-
    Uses the built-in PowerShell commandlet Get-EventLog to search for 'SYSTEM' keyword and saves results to a text file.

    Successful execution will save matching log events to the users temp folder.
  supported_platforms:
  - windows
  input_arguments: 
  dependency_executor_name: 
  dependencies: 
  executor:
    command: powershell -c "get-eventlog 'Security' | where {$_.Message -like '*SYSTEM*'} | export-csv $env:temp\T1654_events.txt"
    cleanup_command: powershell -c "remove-item $env:temp\T1654_events.txt -ErrorAction Ignore"
    name: powershell
    elevation_required: true
